<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Train Scheduler</title>
    <!-- reset css -->
    <link rel="stylesheet" href="assets/css/reset.css">
    <!-- bootstrap -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <!-- jQuery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <!-- moment.js to manipulate date/time -->    
    <script src="https://cdn.jsdelivr.net/momentjs/2.12.0/moment.min.js"></script>
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/6.0.4/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/6.0.4/firebase-database.js"></script> 
    <!-- style css -->
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
    <div class="container-fluid">   
            <h1>Train Scheduler</h1> 
            
            <div class="row  col-sm-3 col-md-4 col-lg-4 offset-0 text-center" id="clock-div" >
            <p> 00:00 <p>
            </div>
        
        
            <div id="input-display-div"> 
                    <form id="schedule-form">
                        <label for="trainNameInput">Train Name</label>
                        <input type="text" id="trainNameInput"></br>
            ​
                        <label for="destInput">Destination</label>
                        <input type="text" id="destInput"></br>
            ​
                        <label for="firstTrainInput">First Train Time (24 Hour format)</label>
                        <input type="text" id="firstTrainInput"></br>
            ​
                        <label for="freqInput">Frequency of Train in Minutes</label>
                        <input type="text" id="freqInput"></br>
            ​
                        <button id="add-schedule" type="button">Add to Schedule</button>
                    </form>   
            </div>     
                
            <div id="schedList-div">
                <table class="table">
                <thead>
                    <tr>
                            <th> Name</th>
                            <th> Destination </th>
                            <th> Arriving </th>
                            <th> Minutes Away </th> 
                        </tr>  
                    </thead>
                    <tbody id="sched-table">
                    </tbody>
                </table>
            </div>
   </div>
  

  
 <script type="text/javascript">;

 curTime=moment().format('HH:mm:ss');       

 // function written to be used with a parm for currentTime so the code is more versitile

function updateTimeClock() {            
            curTime=moment().format('HH:mm:ss'); 
            $("#clock-div p:first").replaceWith("<p> "+ curTime + "</p>"); 
        }

function minutesUntilArrival(startTime, interval, ncurrentTime) {
    console.log("function Arrival Time  start:" + startTime + "  interval: " + interval + "  curr:" + ncurrentTime);

                               
                var startTimeConverted = moment(startTime, "HH:mm");
                console.log("startTimeConverted:  " , startTimeConverted);
                
                // Difference between the times
                var diffTime = moment().diff(moment(startTimeConverted), "minutes");
                console.log("DIFFERENCE IN TIME: " + diffTime);

                // Time apart (remainder)
                var tRemainder = diffTime % interval;
                console.log(tRemainder);

                // Minute Until next occurence
                var tMinutesTill = interval - tRemainder;
                console.log("MINUTES TILL TRAIN: " + tMinutesTill);

                // Next Train
                // var nextTrain = moment().add(tMinutesTillTrain, "minutes");
                // console.log("ARRIVAL TIME: " + moment(nextTrain).format("hh:mm"));
                return tMinutesTill;

  }
                


 // var d=moment.duration(x,'days);
//  d.asHours();
// moment().add(Number, String);

// var m = moment(new Date(2011, 2, 12, 5, 0, 0)); // the day before DST in the US
// m.hours(); // 5
// m.add(24, 'hours').hours(); // 6 (but you may have to set the timezone first)
// setInterval(function, milliseconds, param1, param2, ...)


        curTime=moment().format('HH:mm:ss');           
        console.log("  line 118 curTime  " + curTime);
        $("#clock-div p:first").replaceWith("<p> "+ curTime + "</p>"); 

      
 
      console.log("  line 123 curTime  " + curTime);  
        setInterval(updateTimeClock,1000);
 
var startTime = "0100";
 console.log("  set startTime  " + startTime);
var interval = 30;
 console.log("  set interval: " + interval );

let minutesAway = minutesUntilArrival(startTime, interval, curTime);
console.log('arrival away: ' , minutesAway);
trainArrivalTime= moment().add(minutesAway,"minutes"); 
 console.log("TRAIN arrival time: " + trainArrivalTime.format("HH:mm"));

</script>

</body>
</html>